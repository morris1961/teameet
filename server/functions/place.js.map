{"version":3,"sources":["../../backend/functions/place.js"],"names":["time","UID","DID","status","place_options","isDue","isAdmin","voted","isSelect","place_result","error_msg","Discussion","findById","discussion","key","value","i","length","toString","Date","getTime","deadline","admin","console","log"],"mappings":";;;;;;;AACA;;;;;;;;;;;;;;;;;;;;;;AAEA;SACeA,I;;;;;kEAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAsBC,YAAAA,GAAtB,QAAsBA,GAAtB,EAA2BC,GAA3B,QAA2BA,GAA3B;AACMC,YAAAA,MADN,GACe,KADf;AAEMC,YAAAA,aAFN,GAEsB,EAFtB;AAGMC,YAAAA,KAHN,GAGc,KAHd;AAIMC,YAAAA,OAJN,GAIgB,KAJhB;AAKMC,YAAAA,KALN,GAKc,KALd;AAMMC,YAAAA,QANN,GAMiB,KANjB;AAOMC,YAAAA,YAPN,GAOqB,EAPrB;AAQMC,YAAAA,SARN,GAQkB,oBARlB;AAAA;AAAA;AAAA,mBAU6BC,uBAAWC,QAAX,CAAoBV,GAApB,CAV7B;;AAAA;AAUUW,YAAAA,UAVV;;AAAA,gBAWSA,UAXT;AAAA;AAAA;AAAA;;AAYMV,YAAAA,MAAM,GAAG,KAAT;AACAO,YAAAA,SAAS,GAAG,8BAAZ;AAbN,6CAca;AAAEP,cAAAA,MAAM,EAANA,MAAF;AAAUO,cAAAA,SAAS,EAATA;AAAV,aAdb;;AAAA;AAgBIN,YAAAA,aAAa,GAAGS,UAAU,CAACT,aAA3B;AAhBJ,mDAiB6BA,aAjB7B;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,0DAiBcU,GAjBd,mBAiBmBC,KAjBnB;AAkBeC,YAAAA,CAlBf,GAkBmB,CAlBnB;;AAAA;AAAA,kBAkBsBA,CAAC,GAAGD,KAAK,CAACE,MAlBhC;AAAA;AAAA;AAAA;;AAAA,kBAmBYF,KAAK,CAACC,CAAD,CAAL,CAASE,QAAT,OAAwBjB,GAAG,CAACiB,QAAJ,EAnBpC;AAAA;AAAA;AAAA;;AAoBUX,YAAAA,KAAK,GAAG,IAAR;AApBV;;AAAA;AAkBwCS,YAAAA,CAAC,EAlBzC;AAAA;AAAA;;AAAA;AAAA,iBAwBUT,KAxBV;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AA4BIF,YAAAA,KAAK,GAAI,IAAIc,IAAJ,GAAWC,OAAX,KAAuBP,UAAU,CAACQ,QAAX,CAAoBD,OAApB,EAAxB,IAA0D,CAAlE;AACAd,YAAAA,OAAO,GAAGL,GAAG,CAACiB,QAAJ,OAAmBL,UAAU,CAACS,KAAX,CAAiBJ,QAAjB,EAA7B;AACAT,YAAAA,YAAY,GAAGI,UAAU,CAACJ,YAA1B;AACAD,YAAAA,QAAQ,GAAG,EAAEC,YAAY,IAAI,EAAlB,CAAX;AACAN,YAAAA,MAAM,GAAG,IAAT;AACAO,YAAAA,SAAS,GAAG,YAAZ;AAjCJ;AAAA;;AAAA;AAAA;AAAA;AAmCIa,YAAAA,OAAO,CAACC,GAAR;AACArB,YAAAA,MAAM,GAAG,KAAT;AACAO,YAAAA,SAAS,GAAG,oBAAZ;;AArCJ;AAAA,6CAuCS;AAAEP,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,aAAa,EAAbA,aAAV;AAAyBC,cAAAA,KAAK,EAALA,KAAzB;AAAgCC,cAAAA,OAAO,EAAPA,OAAhC;AAAyCC,cAAAA,KAAK,EAALA,KAAzC;AAAgDC,cAAAA,QAAQ,EAARA,QAAhD;AAA0DC,cAAAA,YAAY,EAAZA,YAA1D;AAAwEC,cAAAA,SAAS,EAATA;AAAxE,aAvCT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;eA0CeV,I","sourcesContent":["// import models\r\nimport Discussion from '../models/discussion.js'\r\n\r\n// function for every cases\r\nasync function time({ UID, DID }) {\r\n  var status = false;\r\n  var place_options = [];\r\n  var isDue = false;\r\n  var isAdmin = false;\r\n  var voted = false;\r\n  var isSelect = false;\r\n  var place_result = \"\";\r\n  var error_msg = \"Something wrong...\";\r\n  try {\r\n    const discussion = await Discussion.findById(DID);\r\n    if (!discussion) {\r\n      status = false;\r\n      error_msg = \"The discussion is not valid!\"\r\n      return { status, error_msg };\r\n    }\r\n    place_options = discussion.place_options;\r\n    for (var [key, value] of place_options) {\r\n      for (let i = 0; i < value.length; i++) {\r\n        if (value[i].toString() === UID.toString()) {\r\n          voted = true;\r\n          break;\r\n        }\r\n      }\r\n      if (voted) {\r\n        break;\r\n      }\r\n    }\r\n    isDue = (new Date().getTime() - discussion.deadline.getTime()) >= 0\r\n    isAdmin = UID.toString() === discussion.admin.toString();\r\n    place_result = discussion.place_result;\r\n    isSelect = !(place_result == \"\")\r\n    status = true;\r\n    error_msg = \"Successed!\";\r\n  } catch (e) {\r\n    console.log(e)\r\n    status = false;\r\n    error_msg = \"Something wrong...\";\r\n  }\r\n  return { status, place_options, isDue, isAdmin, voted, isSelect, place_result, error_msg };\r\n}\r\n\r\nexport default time;"],"file":"place.js"}