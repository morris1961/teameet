{"version":3,"sources":["../../backend/functions/time.js"],"names":["time","UID","DID","status","time_options","isDue","isAdmin","voted","error_msg","isSelect","time_result","Discussion","findById","discussion","old_time_options","key","value","replace","i","length","toString","Date","getTime","deadline","admin","console","log"],"mappings":"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","sourcesContent":["// import models\r\nimport Discussion from '../models/discussion.js'\r\n\r\n// function for every cases\r\nasync function time({ UID, DID }) {\r\n  var status = false;\r\n  var time_options = {};\r\n  var isDue = false;\r\n  var isAdmin = false;\r\n  var voted = false;\r\n  var error_msg = \"Something wrong...\";\r\n  var isSelect = false;\r\n  var time_result = \"\";\r\n  try {\r\n    const discussion = await Discussion.findById(DID);\r\n    if (!discussion) {\r\n      status = false;\r\n      error_msg = \"The discussion is not valid!\"\r\n      return { status, error_msg };\r\n    }\r\n    const old_time_options = discussion.time_options;\r\n    for (var [key, value] of old_time_options) {\r\n      time_options[key.replace(\" \", \".\")] = value;\r\n      if (!voted) {\r\n        for (let i = 0; i < value.length; i++) {\r\n          if (value[i].toString() === UID.toString()) {\r\n            voted = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    isDue = (new Date().getTime() - discussion.deadline.getTime()) >= 0\r\n    isAdmin = UID.toString() === discussion.admin.toString();\r\n    time_result = discussion.time_result;\r\n    isSelect = !(time_result.getTime() - new Date(0).getTime() === 0);\r\n    status = true;\r\n    error_msg = \"Successed!\";\r\n  } catch (e) {\r\n    console.log(e)\r\n    status = false;\r\n    error_msg = \"Something wrong...\";;\r\n  }\r\n  return { status, time_options, isDue, isAdmin, voted, isSelect, time_result, error_msg };\r\n}\r\n\r\nexport default time;"],"file":"time.js"}